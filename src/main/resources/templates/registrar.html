<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Registro de estudiantes</title>
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
          crossorigin="anonymous">
</head>

<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target="#navbar" aria-expanded="false"
                    aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span> <span
                    class="icon-bar"></span> <span class="icon-bar"></span> <span
                    class="icon-bar"></span>
            </button>
            <a class="navbar-brand">Energía Solar</a>
        </div>
    </div>
</nav>

<br>
<br>

<div class="container">
    <div class="row">
        <div class="col-md-6 col-md-offset-3">

            <h1>Registrar panel solar</h1>
            <form id="registrarPanelForm" method="POST" th:action="'/paneles'" th:object="${panel}">
                <div class="form-group">
                    <label class="control-label" for="brand">Marca: </label>
                    <input id="brand" name="brand" type="text" class="form-control" th:field="*{brand}" required autofocus="autofocus">
                </div>
                <div class="form-group">
                    <label class="control-label" for="model">Modelo: </label>
                    <input id="model" name="model" type="text" class="form-control" th:field="*{model}" required
                           autofocus="autofocus">
                </div>
                <div class="form-group">
                    <label class="control-label" for="category">Categoria: </label>
                    <input id="category" name="category" type="text" class="form-control" th:field="*{category}" required
                           autofocus="autofocus">
                </div>
                <div class="form-group">
                    <label class="control-label" for="efficiency">Eficiencia: </label>
                    <input id="efficiency" name="efficiency" type="text" class="form-control" th:field="*{efficiency}" required
                           autofocus="autofocus">
                </div>
                <div class="form-group">
                    <label class="control-label" for="nominalPower">Potencia: </label>
                    <input id="nominalPower" name="nominalPower" type="number" step="0.1" class="form-control" th:field="*{nominalPower}"
                           autofocus="autofocus">
                </div>
                <div class="form-group">
                    <label class="control-label" for="price">Precio: </label>
                    <input id="price" name="price" type="number" step="0.01" class="form-control" th:field="*{price}"
                           autofocus="autofocus">
                </div>
                <div class="form-group">
                    <label class="control-label" for="productionDate">Fecha de fabricación: </label>
                    <input id="productionDate" name="productionDate" type="date" class="form-control" th:field="*{productionDate}"
                           autofocus="autofocus">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-success" onClick="registerPanel()" href="paneles.html">Registrar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script
        src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous">
</script>

<script>
async function registerPanel() {

      let datos = {};
      datos.brand = document.getElementById('brand').value;
      datos.model = document.getElementById('model').value;
      datos.category = document.getElementById('category').value;
      datos.efficiency = document.getElementById('efficiency').value;
      datos.nominalPower = document.getElementById('nominalPower').value;
      datos.price = document.getElementById('price').value;
      datos.productionDate = document.getElementById('productionDate').value;


      const request = await fetch('/paneles/registrar', {
        method: 'POST',
        headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
        },
        body: JSON.stringify(datos)       // Coge cualquier objeto de JS y lo convierte a un String de JSON
      });

      window.location.href = 'paneles.html';

    }
</script>

</body>
</html>